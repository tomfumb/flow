define("data/en",["jquery"],function(e){return config={lists:{countries:["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas, The","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei ","Bulgaria","Burkina Faso","Burma","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo, Democratic Republic of the","Congo, Republic of the","Costa Rica","Cote d'Ivoire","Croatia","Cuba","Curacao","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","East Timor","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Fiji","Finland","France","Gabon","Gambia, The","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea-Bissau","Guinea","Guyana","Haiti","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Korea, North","Korea, South","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Zealand","Nicaragua","Niger","Nigeria","North Korea","Norway","Oman","Pakistan","Palau","Palestinian Territories","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Sahrawi Arab Democratic Republic (Western Sahara)","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Sint Maarten","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],yesnounknown:["Yes","No","Unknown"]}},config.questions=[{id:"1",content:"In what country did the abuse(s) occur?",explanations:["Territorial jurisdiction/admissibility. To determine whether the victim's abuse would come within the mechanism's jurisdiction because it happened on a state party's territory or on the territory of a country covered by the mechanism."],answers:config.lists.countries,answerType:"single-select"},{id:"2a",content:"Did people from any other country participate in the abuse(s)?",answers:config.lists.yesnounknown,answerType:"single-select"},{id:"2b",content:"What country were the people from?",explanations:["Territorial jurisdiction/admissibility. To determine whether the victim's abuse would come within the mechanism's jurisdiction because it was committed by the citizen of a state party or by a citizen of a country covered by the mechanism."],answers:config.lists.countries,answerType:"single-select",condition:function(e){return e["2a"].hasAnswer("Yes")}},{id:"3",content:"What is the date on which the abuse(s) happened (if the abuses included detention or torture, when did the detention or torture end)?",explanations:["Temporal jurisdiction/admissibility. To determine whether the victim's abuse would come within the mechanism's jurisdiction â€“ i.e. either when the particular country signed on to the treaty/acceded to the mechanisms or when the treaty/mechanism came into force."],answerType:"single-date"},{id:"4",content:"At the time of the abuse(s), what country was the victim a citizen of?",answers:config.lists.countries,answerType:"single-select"},{id:"5a",content:"At the time of the abuse(s), was the victim a citizen of any other country?",answers:config.lists.yesnounknown,answerType:"single-select"},{id:"5b",content:"Of which other country was the victim a citizen at the time of the abuse(s)?",answers:config.lists.countries,answerType:"single-select",condition:function(e){return e["5a"].hasAnswer("Yes")}},{id:"6",content:"Describe the abuse(s) committed against the victim",explanations:["Subject matter jurisdiction/admissibility. To determine whether the victim's abuse constitutes a crime/violation that comes within the mechanism's subject matter jurisdiction."],answers:["Beating","Bodily mutilation","Burning","Burning of houses","Death threats","Denial of fair trial","Deprivation of medical care","Destruction or serious damage to property","Electric shock","Enslavement","Forced abortion","Forced displacement","Forced nudity","Forced sterilization","Forced stress positions","Forced to watch abuse of other prisoners","Forcing a prisoner to perform military service","Incommunicado detention","Kicking","Kidnapping/disappearance","Killing","Mock execution","Persecutions on political, racial, or religious grounds","Poisoning of water or food supplies","Prolonged exposure to extreme cold or heat","Prolonged food/water deprivation","Prolonged sleep deprivation","Punching","Rape or other sexual assault","Religious persecution","Serious mental harm to a person based on race, ethnicity, religion or nationality","Severe mental suffering","Solitary confinement","Stealing children","Suffocation","Waterboarding"],answerType:"multi-select"},{id:"7",content:"Did the abuse(s) take place during a war?",explanations:["Subject matter jurisdiction over War Crimes. To determine whether the victim's abuse constitutes a war crime such that it comes within the mechanism's subject matter jurisdiction."],answers:config.lists.yesnounknown,answerType:"single-select"},{id:"8",content:"Were these kinds of abuses committed against many other people in the country at that time?",explanations:["Subject matter jurisdiction over Crimes Against Humanity. To determine whether the victim's abuse constitutes a crime against humanity such that it comes within the mechanism's subject matter jurisdiction."],answers:config.lists.yesnounknown,answerType:"single-select"},{id:"9",content:"Was the victim targeted because of her/his race, ethnicity, religion or nationality?",explanations:["Subject matter jurisdiction over Genocide. To determine whether the victim's abuse constitutes genocide such that it comes within the mechanism's subject matter jurisdiction."],answers:config.lists.yesnounknown,answerType:"single-select"},{id:"10",content:"Who committed the abuse(s)?",explanations:["Subject matter jurisdiction over Torture. To determine whether the victim's abuse constitutes torture such that it comes within the mechanism's subject matter jurisdiction;","Immunity. To determine if the abuse was committed by a government actor such that there would be immunity in Canadian courts;","Territorial jurisdiction. To determine if the country  where the abuse happened is responsible because the perpetrator was a government actor or not responsible because the abuse was committed by a non-government actor (e.g. a rebel group)."],answers:["Soldier in government's army","Police officer","Other government official","Soldier in rebel army","Person in plainclothes","Company or corporation","Unknown"],answerType:"multi-select"},{id:"11",content:"Are any of the people responsible for the abuse(s) currently living in Canada?",explanations:["Territorial jurisdiction for action in Canada. To determine if a criminal UJ case or immigration penalty might be possible in Canada."],answers:config.lists.yesnounknown,answerType:"single-select"},{id:"12",content:"Do any of the people responsible for the abuse(s) ever visit Canada?",explanations:["Territorial jurisdiction for action in Canada. To determine if a criminal UJ case or immigration penalty might be possible in Canada"],answers:config.lists.yesnounknown,answerType:"single-select"},{id:"13",content:"Do any of the people responsible for the abuse(s) ever travel outside the country where the abuse(s) happened?",answers:config.lists.yesnounknown,answerType:"single-select"},{id:"14a",content:"In your opinion, in the country where the abuse(s) occurred, are the courts fair, independent and impartial, such that justice can be achieved there?",answers:config.lists.yesnounknown,answerType:"single-select"},{id:"14b",content:"Did the victim or the victim's family try to bring a case or a complaint before the courts, the police or other authorities in the country where the abuses occurred?",answers:config.lists.yesnounknown,answerType:"single-select"},{id:"14c",content:"What was the result?",explanations:["Admissibility re exhaustion of domestic remedies. To determine whether the mechanism would reject the case based availability of remedies in country where the abuses happened."],answers:["Investigation or prosecution still ongoing","No investigation","Inadequate investigation","A court held someone responsible","Someone was put on trial but was found not guilty"],answerType:"single-select",condition:function(e){return e["14b"].hasAnswer("Yes")}},{id:"15",content:"Has the victim or the victim's family submitted a complaint to any other international court or body?",explanations:["Admissibility re deference to other bodies. To determine whether the mechanism would reject the case based a complaint before another international body."],answers:config.lists.yesnounknown,answerType:"single-select"}],config.outcomes=[{selector:e("#ccij_outcome_icc"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_cat"),condition:function(e,t,n,r,i,s,o,u,a,f){var l=["Algeria","Andorra","Argentina","Australia","Austria","Azerbaijan","Belgium","Bolivia","Bosnia and Herzegovina","Brazil","Bulgaria","Burundi","Cameroon","Canada","Chile","Costa Rica","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Finland","France","Georgia","Germany","Ghana","Greece","Guatemala","Guinea-Bissau","Hungary","Iceland","Ireland","Italy","Kazakhstan","Liechtenstein","Luxembourg","Malta","Mexico","Monaco","Montenegro","Morocco","Netherlands","New Zealand","Norway","Paraguay","Peru","Poland","Portugal","Qatar","South Korea","Moldova","Russia","Senegal","Serbia","Seychelles","Slovakia","Slovenia","South Africa","Spain","Sweden","Switzerland","Togo","Tunisia","Turkey","Ukraine","Uruguay","Venezuela"],c=["Beating","Bodily mutilation","Burning","Death threats","Deprivation of medical care","Electric shock","Forced stress positions","Forced nudity","Forced to watch abuse of other prisoners","Incommunicado detention","Kicking","Mock execution","Prolonged exposure to extreme cold or heat","Prolonged food/water deprivation","Prolonged sleep deprivation","Punching","Rape or other sexual assault","Severe mental suffering","Solitary confinement","Suffocation","Waterboarding"],h=["Soldier in government's army","Police officer","Other government official"],p=["Investigation or prosecution still ongoing","A court held someone responsible","Someone was put on trial but was found not guilty"],d=!1;if(e.isNotAnswered()||e.hasOneOfAnswers(l))d=!0;t.hasAnswer("Yes")&&n.hasOneOfAnswers(l)&&(d=!0);if(!d)return!1;var v=!1;if(r.isNotAnswered()||(e.hasAnswer("Algeria")||n.hasAnswer("Algeria"))&&r.isAfterOrOnDate("1989/09/12")||(e.hasAnswer("Andorra")||n.hasAnswer("Andorra"))&&r.isAfterOrOnDate("2006/09/22")||(e.hasAnswer("Argentina")||n.hasAnswer("Argentina"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Australia")||n.hasAnswer("Australia"))&&r.isAfterOrOnDate("1989/08/08")||(e.hasAnswer("Austria")||n.hasAnswer("Austria"))&&r.isAfterOrOnDate("1987/07/29")||(e.hasAnswer("Azerbaijan")||n.hasAnswer("Azerbaijan"))&&r.isAfterOrOnDate("1996/08/16")||(e.hasAnswer("Belgium")||n.hasAnswer("Belgium"))&&r.isAfterOrOnDate("1999/06/25")||(e.hasAnswer("Bolivia")||n.hasAnswer("Bolivia"))&&r.isAfterOrOnDate("1999/04/12")||(e.hasAnswer("Bosnia and Herzegovina")||n.hasAnswer("Bosnia and Herzegovina"))&&r.isAfterOrOnDate("1993/09/01")||(e.hasAnswer("Brazil")||n.hasAnswer("Brazil"))&&r.isAfterOrOnDate("1989/09/28")||(e.hasAnswer("Bulgaria")||n.hasAnswer("Bulgaria"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Burundi")||n.hasAnswer("Burundi"))&&r.isAfterOrOnDate("1993/02/18")||(e.hasAnswer("Cameroon")||n.hasAnswer("Cameroon"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Canada")||n.hasAnswer("Canada"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Chile")||n.hasAnswer("Chile"))&&r.isAfterOrOnDate("1988/09/30")||(e.hasAnswer("Costa Rica")||n.hasAnswer("Costa Rica"))&&r.isAfterOrOnDate("1993/11/11")||(e.hasAnswer("Croatia")||n.hasAnswer("Croatia"))&&r.isAfterOrOnDate("1992/10/12")||(e.hasAnswer("Cyprus")||n.hasAnswer("Cyprus"))&&r.isAfterOrOnDate("1991/07/18")||(e.hasAnswer("Czech Republic")||n.hasAnswer("Czech Republic"))&&r.isAfterOrOnDate("1993/02/22")||(e.hasAnswer("Denmark")||n.hasAnswer("Denmark"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Ecuador")||n.hasAnswer("Ecuador"))&&r.isAfterOrOnDate("1988/03/30")||(e.hasAnswer("Finland")||n.hasAnswer("Finland"))&&r.isAfterOrOnDate("1989/08/30")||(e.hasAnswer("France")||n.hasAnswer("France"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Georgia")||n.hasAnswer("Georgia"))&&r.isAfterOrOnDate("1994/10/26")||(e.hasAnswer("Germany")||n.hasAnswer("Germany"))&&r.isAfterOrOnDate("1990/10/01")||(e.hasAnswer("Ghana")||n.hasAnswer("Ghana"))&&r.isAfterOrOnDate("2000/09/07")||(e.hasAnswer("Greece")||n.hasAnswer("Greece"))&&r.isAfterOrOnDate("1988/10/06")||(e.hasAnswer("Guatemala")||n.hasAnswer("Guatemala"))&&r.isAfterOrOnDate("1990/01/05")||(e.hasAnswer("Guinea-Bissau")||n.hasAnswer("Guinea-Bissau"))&&r.isAfterOrOnDate("2013/09/24")||(e.hasAnswer("Hungary")||n.hasAnswer("Hungary"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Iceland")||n.hasAnswer("Iceland"))&&r.isAfterOrOnDate("1996/10/23")||(e.hasAnswer("Ireland")||n.hasAnswer("Ireland"))&&r.isAfterOrOnDate("2002/04/11")||(e.hasAnswer("Italy")||n.hasAnswer("Italy"))&&r.isAfterOrOnDate("1989/01/12")||(e.hasAnswer("Kazakhstan")||n.hasAnswer("Kazakhstan"))&&r.isAfterOrOnDate("1998/08/26")||(e.hasAnswer("Liechtenstein")||n.hasAnswer("Liechtenstein"))&&r.isAfterOrOnDate("1990/09/02")||(e.hasAnswer("Luxembourg")||n.hasAnswer("Luxembourg"))&&r.isAfterOrOnDate("1987/09/29")||(e.hasAnswer("Malta")||n.hasAnswer("Malta"))&&r.isAfterOrOnDate("1990/09/13")||(e.hasAnswer("Mexico")||n.hasAnswer("Mexico"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Monaco")||n.hasAnswer("Monaco"))&&r.isAfterOrOnDate("1991/12/06")||(e.hasAnswer("Montenegro")||n.hasAnswer("Montenegro"))&&r.isAfterOrOnDate("2006/10/23")||(e.hasAnswer("Morocco")||n.hasAnswer("Morocco"))&&r.isAfterOrOnDate("1993/06/21")||(e.hasAnswer("Netherlands")||n.hasAnswer("Netherlands"))&&r.isAfterOrOnDate("1988/12/21")||(e.hasAnswer("New Zealand")||n.hasAnswer("New Zealand"))&&r.isAfterOrOnDate("1989/12/10")||(e.hasAnswer("Norway")||n.hasAnswer("Norway"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Paraguay")||n.hasAnswer("Paraguay"))&&r.isAfterOrOnDate("1990/03/12")||(e.hasAnswer("Peru")||n.hasAnswer("Peru"))&&r.isAfterOrOnDate("1988/07/07")||(e.hasAnswer("Poland")||n.hasAnswer("Poland"))&&r.isAfterOrOnDate("1989/06/26")||(e.hasAnswer("Portugal")||n.hasAnswer("Portugal"))&&r.isAfterOrOnDate("1989/02/09")||(e.hasAnswer("Qatar")||n.hasAnswer("Qatar"))&&r.isAfterOrOnDate("2012/03/14")||(e.hasAnswer("South Korea")||n.hasAnswer("South Korea"))&&r.isAfterOrOnDate("1995/01/09")||(e.hasAnswer("Moldova")||n.hasAnswer("Moldova"))&&r.isAfterOrOnDate("1995/11/28")||(e.hasAnswer("Russia")||n.hasAnswer("Russia"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Senegal")||n.hasAnswer("Senegal"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Serbia")||n.hasAnswer("Serbia"))&&r.isAfterOrOnDate("2001/03/12")||(e.hasAnswer("Seychelles")||n.hasAnswer("Seychelles"))&&r.isAfterOrOnDate("1992/05/05")||(e.hasAnswer("Slovakia")||n.hasAnswer("Slovakia"))&&r.isAfterOrOnDate("1993/05/28")||(e.hasAnswer("Slovenia")||n.hasAnswer("Slovenia"))&&r.isAfterOrOnDate("1993/07/16")||(e.hasAnswer("South Africa")||n.hasAnswer("South Africa"))&&r.isAfterOrOnDate("1998/12/10")||(e.hasAnswer("Spain")||n.hasAnswer("Spain"))&&r.isAfterOrOnDate("1987/10/21")||(e.hasAnswer("Sweden")||n.hasAnswer("Sweden"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Switzerland")||n.hasAnswer("Switzerland"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Togo")||n.hasAnswer("Togo"))&&r.isAfterOrOnDate("1987/11/18")||(e.hasAnswer("Tunisia")||n.hasAnswer("Tunisia"))&&r.isAfterOrOnDate("1988/09/23")||(e.hasAnswer("Turkey")||n.hasAnswer("Turkey"))&&r.isAfterOrOnDate("1988/08/02")||(e.hasAnswer("Ukraine")||n.hasAnswer("Ukraine"))&&r.isAfterOrOnDate("2003/09/12")||(e.hasAnswer("Uruguay")||n.hasAnswer("Uruguay"))&&r.isAfterOrOnDate("1987/06/26")||(e.hasAnswer("Venezuela")||n.hasAnswer("Venezuela"))&&r.isAfterOrOnDate("1991/07/29"))v=!0;if(!v)return!1;var m=i.isNotAnswered()||i.hasOneOfAnswers(c);if(!m)return!1;var g=s.isUnknownOrNotAnswered()||s.hasOneOfAnswers(h);if(!g)return!1;var y=!1;if(o.isUnknownOrNotAnswered()||o.hasAnswer("No")||o.hasAnswer("Yes")&&u.isUnknownOrNotAnswered()||o.hasAnswer("Yes")&&u.hasAnswer("Yes")&&a.isNotAnswered()||o.hasAnswer("Yes")&&u.hasAnswer("Yes")&&!a.hasOneOfAnswers(p))y=!0;if(!y)return!1;var b=!1;return f.doesNotHaveAnswer("Yes")&&(b=!0),b?!0:!1}},{selector:e("#ccij_outcome_un_hrc"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_cerd"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_cedaw"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_ced"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_cescr"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_crc"),condition:function(e){return!0}},{selector:e("#ccij_outcome_un_wgeid"),condition:function(e){return!0}},{selector:e("#ccij_outcome_ia_chr"),condition:function(e){return!0}},{selector:e("#ccij_outcome_acm_hpr"),condition:function(e,t,n,r,i,s,o,u,a,f){var l=["Algeria","Angola","Benin","Botswana","Burkina Faso","Burundi","Cameroon","Central African Republic","Cape Verde","Chad","Cote d'Ivoire","Comoros","Congo, Democratic Republic of the","Congo, Republic of the","Djibouti","Egypt","Equatorial Guinea","Eritrea","Ethiopia","Gabon","Gambia, The","Ghana","Guinea-Bissau","Guinea","Kenya","Libya","Lesotho","Liberia","Madagascar","Mali","Malawi","Mozambique","Mauritania","Mauritius","Namibia","Nigeria","Niger","Rwanda","South Africa","Sahrawi Arab Democratic Republic (Western Sahara)","Senegal","Seychelles","Sierra Leone","Somalia","Sao Tome and Principe","Sudan","Swaziland","Tanzania","Togo","Tunisia","Uganda","Zambia","Zimbabwe"],c=["Beating","Bodily mutilation","Burning","Death threats","Deprivation of medical care","Electric shock","Forced stress positions","Forced nudity","Forced to watch abuse of other prisoners","Incommunicado detention","Kicking","Kidnapping/disappearance","Killing","Mock execution","Prolonged exposure to extreme cold or heat","Prolonged food/water deprivation","Prolonged sleep deprivation","Punching","Rape or other sexual assault","Severe mental suffering","Solitary confinement","Suffocation","Waterboarding"],h=["Soldier in government's army","Police officer","Other government official"],p=["Investigation or prosecution still ongoing","A court held someone responsible","Someone was put on trial but was found not guilty"],d=!1;if(e.isNotAnswered()||e.hasOneOfAnswers(l))d=!0;t.hasAnswer("Yes")&&n.hasOneOfAnswers(l)&&(d=!0);if(!d)return!1;var v=!1;if(r.isNotAnswered()||(e.hasAnswer("Algeria")||n.hasAnswer("Algeria"))&&r.isAfterOrOnDate("1987/03/01")||(e.hasAnswer("Angola")||n.hasAnswer("Angola"))&&r.isAfterOrOnDate("1990/03/02")||(e.hasAnswer("Benin")||n.hasAnswer("Benin"))&&r.isAfterOrOnDate("1986/01/20")||(e.hasAnswer("Botswana")||n.hasAnswer("Botswana"))&&r.isAfterOrOnDate("1986/07/17")||(e.hasAnswer("Burkina Faso")||n.hasAnswer("Burkina Faso"))&&r.isAfterOrOnDate("1984/07/06")||(e.hasAnswer("Burundi")||n.hasAnswer("Burundi"))&&r.isAfterOrOnDate("1989/07/28")||(e.hasAnswer("Cameroon")||n.hasAnswer("Cameroon"))&&r.isAfterOrOnDate("1989/06/20")||(e.hasAnswer("Central African Republic")||n.hasAnswer("Central African Republic"))&&r.isAfterOrOnDate("1986/04/26")||(e.hasAnswer("Cape Verde")||n.hasAnswer("Cape Verde"))&&r.isAfterOrOnDate("1987/06/02")||(e.hasAnswer("Chad")||n.hasAnswer("Chad"))&&r.isAfterOrOnDate("1986/10/09")||(e.hasAnswer("Cote d'Ivoire")||n.hasAnswer("Cote d'Ivoire"))&&r.isAfterOrOnDate("1992/01/06")||(e.hasAnswer("Comoros")||n.hasAnswer("Comoros"))&&r.isAfterOrOnDate("1986/06/01")||(e.hasAnswer("Congo, Republic of the")||n.hasAnswer("Congo, Republic of the"))&&r.isAfterOrOnDate("1982/12/09")||(e.hasAnswer("Djibouti")||n.hasAnswer("Djibouti"))&&r.isAfterOrOnDate("1991/11/11")||(e.hasAnswer("Congo, Democratic Republic of the")||n.hasAnswer("Congo, Democratic Republic of the"))&&r.isAfterOrOnDate("1987/07/20")||(e.hasAnswer("Egypt")||n.hasAnswer("Egypt"))&&r.isAfterOrOnDate("1984/03/20")||(e.hasAnswer("Equatorial Guinea")||n.hasAnswer("Equatorial Guinea"))&&r.isAfterOrOnDate("1986/04/07")||(e.hasAnswer("Eritrea")||n.hasAnswer("Eritrea"))&&r.isAfterOrOnDate("1999/01/14")||(e.hasAnswer("Ethiopia")||n.hasAnswer("Ethiopia"))&&r.isAfterOrOnDate("1998/06/15")||(e.hasAnswer("Gabon")||n.hasAnswer("Gabon"))&&r.isAfterOrOnDate("1986/02/20")||(e.hasAnswer("Gambia, The")||n.hasAnswer("Gambia, The"))&&r.isAfterOrOnDate("1983/06/08")||(e.hasAnswer("Ghana")||n.hasAnswer("Ghana"))&&r.isAfterOrOnDate("1989/01/24")||(e.hasAnswer("Guinea-Bissau")||n.hasAnswer("Guinea-Bissau"))&&r.isAfterOrOnDate("1985/12/04")||(e.hasAnswer("Guinea")||n.hasAnswer("Guinea"))&&r.isAfterOrOnDate("1982/02/16")||(e.hasAnswer("Kenya")||n.hasAnswer("Kenya"))&&r.isAfterOrOnDate("1992/01/23")||(e.hasAnswer("Libya")||n.hasAnswer("Libya"))&&r.isAfterOrOnDate("1986/07/19")||(e.hasAnswer("Lesotho")||n.hasAnswer("Lesotho"))&&r.isAfterOrOnDate("1992/02/10")||(e.hasAnswer("Liberia")||n.hasAnswer("Liberia"))&&r.isAfterOrOnDate("1982/08/04")||(e.hasAnswer("Madagascar")||n.hasAnswer("Madagascar"))&&r.isAfterOrOnDate("1992/03/09")||(e.hasAnswer("Mali")||n.hasAnswer("Mali"))&&r.isAfterOrOnDate("1981/12/21")||(e.hasAnswer("Malawi")||n.hasAnswer("Malawi"))&&r.isAfterOrOnDate("1989/11/17")||(e.hasAnswer("Mozambique")||n.hasAnswer("Mozambique"))&&r.isAfterOrOnDate("1989/02/22")||(e.hasAnswer("Mauritania")||n.hasAnswer("Mauritania"))&&r.isAfterOrOnDate("1986/06/14")||(e.hasAnswer("Mauritius")||n.hasAnswer("Mauritius"))&&r.isAfterOrOnDate("1992/06/19")||(e.hasAnswer("Namibia")||n.hasAnswer("Namibia"))&&r.isAfterOrOnDate("1992/07/30")||(e.hasAnswer("Nigeria")||n.hasAnswer("Nigeria"))&&r.isAfterOrOnDate("1983/06/22")||(e.hasAnswer("Niger")||n.hasAnswer("Niger"))&&r.isAfterOrOnDate("1986/07/15")||(e.hasAnswer("Rwanda")||n.hasAnswer("Rwanda"))&&r.isAfterOrOnDate("1983/07/15")||(e.hasAnswer("South Africa")||n.hasAnswer("South Africa"))&&r.isAfterOrOnDate("1996-07-09")||(e.hasAnswer("Sahrawi Arab Democratic Republic (Western Sahara)")||n.hasAnswer("Sahrawi Arab Democratic Republic (Western Sahara)"))&&r.isAfterOrOnDate("1986/05/02")||(e.hasAnswer("Senegal")||n.hasAnswer("Senegal"))&&r.isAfterOrOnDate("1982/08/13")||(e.hasAnswer("Seychelles")||n.hasAnswer("Seychelles"))&&r.isAfterOrOnDate("1992-04-13")||(e.hasAnswer("Sierra Leone")||n.hasAnswer("Sierra Leone"))&&r.isAfterOrOnDate("1983/09/21")||(e.hasAnswer("Somalia")||n.hasAnswer("Somalia"))&&r.isAfterOrOnDate("1985/07/31")||(e.hasAnswer("Sao Tome and Principe")||n.hasAnswer("Sao Tome and Principe"))&&r.isAfterOrOnDate("1986/05/23")||(e.hasAnswer("Sudan")||n.hasAnswer("Sudan"))&&r.isAfterOrOnDate("1986/02/18")||(e.hasAnswer("Swaziland")||n.hasAnswer("Swaziland"))&&r.isAfterOrOnDate("1995/09/15")||(e.hasAnswer("Tanzania")||n.hasAnswer("Tanzania"))&&r.isAfterOrOnDate("1984/02/18")||(e.hasAnswer("Togo")||n.hasAnswer("Togo"))&&r.isAfterOrOnDate("1982/11/05")||(e.hasAnswer("Tunisia")||n.hasAnswer("Tunisia"))&&r.isAfterOrOnDate("1983/03/16")||(e.hasAnswer("Uganda")||n.hasAnswer("Uganda"))&&r.isAfterOrOnDate("1986/05/10")||(e.hasAnswer("Zambia")||n.hasAnswer("Zambia"))&&r.isAfterOrOnDate("1984/01/10")||(e.hasAnswer("Zimbabwe")||n.hasAnswer("Zimbabwe"))&&r.isAfterOrOnDate("1986/05/30"))v=!0;if(!v)return!1;var m=i.isNotAnswered()||i.hasOneOfAnswers(c);if(!m)return!1;var g=s.isUnknownOrNotAnswered()||s.hasOneOfAnswers(h);if(!g)return!1;var y=!1;if(o.isUnknownOrNotAnswered()||o.hasAnswer("No")||o.hasAnswer("Yes")&&u.isUnknownOrNotAnswered()||o.hasAnswer("Yes")&&u.hasAnswer("Yes")&&a.isNotAnswered()||o.hasAnswer("Yes")&&u.hasAnswer("Yes")&&!a.hasOneOfAnswers(p))y=!0;if(!y)return!1;var b=!1;return f.doesNotHaveAnswer("Yes")&&(b=!0),b?!0:!1}},{selector:e("#ccij_outcome_act_hpr"),condition:function(e){return!0}},{selector:e("#ccij_outcome_ecowas"),condition:function(e){return!0}},{selector:e("#ccij_outcome_echr"),condition:function(e){return!0}},{selector:e("#ccij_outcome_eccc"),condition:function(e,t,n,r,i,s,o,u,a){var f=["Cambodia"],l=["Beating","Bodily mutilation","Burning","Burning of houses","Death threats","Denial of fair trial","Deprivation of medical care","Destruction or serious damage to property","Electric shock","Enslavement","Forced abortion","Forced displacement","Forced nudity","Forced sterilization","Forced stress positions","Forced to watch abuse of other prisoners","Forcing a prisoner to perform military service","Incommunicado detention","Kicking","Kidnapping/disappearance","Killing","Mock execution","Persecutions on political, racial, or religious grounds","Poisoning of water or food supplies","Prolonged exposure to extreme cold or heat","Prolonged food/water deprivation","Prolonged sleep deprivation","Punching","Rape or other sexual assault","Religious persecution","Serious mental harm to a person based on race, ethnicity, religion or nationality","Severe mental suffering","Solitary confinement","Stealing children","Suffocation","Waterboarding"],c=["Soldier in government's army","Police officer","Other government official"],h=!1;if(e.isNotAnswered()||e.hasOneOfAnswers(f))h=!0;t.hasAnswer("Yes")&&n.hasOneOfAnswers(f)&&(h=!0);if(!h)return!1;var p=!1;if(r.isNotAnswered()||(e.hasAnswer("Cambodia")||n.hasAnswer("Cambodia"))&&r.isBetweenDates("1975/04/17","1979/01/06"))p=!0;if(!p)return!1;var d=i.isNotAnswered()||i.hasOneOfAnswers(l);if(!d)return!1;var v=!0;s.hasAnswer("No")&&o.hasAnswer("No")&&u.hasAnswer("No")&&(v=!1);if(!v)return!1;var m=a.isUnknownOrNotAnswered()||a.hasOneOfAnswers(c);return m?!0:!1}},{selector:e("#ccij_outcome_bosnia"),condition:function(e){return!0}},{selector:e("#ccij_outcome_crim_pro_can"),condition:function(e){return!0}},{selector:e("#ccij_outcome_civ_law_can"),condition:function(e){return!0}},{selector:e("#ccij_outcome_imm_pen_can"),condition:function(e){return!0}}],config}),define("flow/Log",[],function(){return{logLevels:{ERROR:1,WARNING:2,INFO:3,DEBUG:4},logLevel:undefined,lastLogTime:undefined,defaultLogLevel:4,logGapInterval:200,init:function(){return window.console=window.console||{log:function(){},error:function(){}},this},debug:function(e){this.log(this.logLevels.DEBUG,e,!1)},info:function(e){this.log(this.logLevels.INFO,e,!1)},warning:function(e){this.log(this.logLevels.WARNING,e,!1)},error:function(e){this.log(this.logLevels.ERROR,e,!0)},log:function(e,t,n){var r,i,s;n=typeof n=="undefined"?!1:!0,r=typeof this.logLevel=="undefined"?this.defaultLogLevel:this.logLevel;if(r>=e){logLevelName="unknown";for(s in this.logLevels)this.logLevels.hasOwnProperty(s)&&this.logLevels[s]===e&&(levelName=s);var o=(new Date).getTime(),u="["+levelName+" "+o+"]: "+t;e===this.logLevels.ERROR?console.error(u):(this.lastLogTime&&o-this.lastLogTime>=this.logGapInterval&&console.log(""),console.log(u)),this.lastLogTime=o}}}.init()}),define("flow/IntroView",["jquery","underscore","backbone","flow/Log"],function(e,t,n,r){return n.View.extend({template:['<div class="container">',"	<h3>Intro Text</h3>","	<p>This will contain a disclaimer about how users may not get foolproof results from the assess tool and are strongly advised to discuss their case with a CCIJ lawyer. Legal cases should not be based on the outcome of this test.</p>",'	<button id="flow_start" type="button" class="btn btn-default" disabled="disabled">I understand</button>',"</div>"].join(""),render:function(){this.$el.html(t.template(this.template))},initialize:function(){r.debug("initialising IntroView"),this.listenToOnce(this.model,"reset",t.bind(this.onQuestionsReset,this))},onQuestionsReset:function(){r.debug("IntroView.onQuestionsReset"),this.$el.find("#flow_start").removeAttr("disabled").on("click",t.bind(this.onStartRequested,this))},onStartRequested:function(e){r.debug("IntroView.onStartRequested"),e&&typeof e.preventDefault=="function"&&e.preventDefault(),this.$el.hide(),this.model.readyForFirstQuestion()}})}),define("theme/QuestionView",["jquery","underscore","backbone","flow/Log","jquery-ui"],function(e,t,n,r){return n.View.extend({singleAnswerThreshold:5,answerDisplayTypes:{EL_CLICK:"el_click",LIST_SELECT:"list_select",CHECKBOXES:"check_button_click",SINGLE_DATE:"single_date"},template_base:['<div class="carousel-caption">','	<div id="question_<%= question.get("id") %>" class="question">','		<h4>Question <%= question.get("id") %></h4>','		<p><%= question.get("content") %></p>',"		<% if(explanations && explanations.length) { %>",'		<div class="question-explanation">','			<div class="question-explanation-header clickable clickable-colour">','				<img src="images/0.png" class="sprites emblem-notice" width="24" height="24" title="Why this question?" />',"				Why this question?","			</div>",'			<div class="question-explanation-content">',"				<ul>","				<% _.each(explanations, function(explanation) { %> ","					<li><%= explanation %></li>","				<% }) %>","				</ul>","			</div>","		</div>","		<% } %>","	</div>",'	<div id="answers_<%= question.get("id") %>" class="answers">'].join(""),template_single_few:["		<p>Select an answer below.</p>","		<% _.each(answers, function(answer, index) { %>",'			<div class="answer clickable" id="answer_<%= index %>">','				<div class="answer-pad"></div>','				<div class="answer-content"><%= answer %></div>','				<div class="clearer"></div>',"			</div>","		<% }); %>"].join(""),template_single_many:["		<p>Select an answer from the drop-down menu below.</p>",'		<select class="multi_answer_select">','			<option value="">Please Select...</option>',"			<% _.each(answers, function(answer, index) { %>",'				<option type="text" value="<%= answer %>"><%= answer %></option>',"			<% }); %>","		</select>"].join(""),template_multi:["		<p>Select all that apply from the following options.</p>",'		<div class="container" style="width: 100%">','			<div class="row">','				<div class="col-xs-24 col-sm-24 col-md-24 col-lg-24 minor-info">Check all that apply</div>',"			</div>",'			<div class="row">',"				<% _.each(answers, function(answer, index) { %>",'					<div class="col-xs-24 col-sm-24 col-md-12 col-lg-12">','						<input type="checkbox" id="q<%= question.get("id") %>_a_<%= index %>" /> <span class="answer-checkbox-text clickable"><%= answer %></span>',"					</div>","				<% }); %>","			</div>",'			<div class="row spacer-10">','				<button class="continue btn btn-default" type="button">Done</button>',"			</div>","		</div>"].join(""),template_single_date:["		<p>Provide a date using the date-picker below.</p>",'		<input type="text" class="date-selector hint-text" value="YYYY/MM/DD" />'].join(""),template_end:["	</div>","	<hr />","</div>"].join(""),render:function(n,i){r.debug("QuestionView.render"),n=typeof n=="undefined"?!1:!!n,this.container=i,this.$el.addClass("item"),n&&this.$el.addClass("active");var s,o;switch(this.model.get("answerType")){case"single-select":this.model.get("answers").length>this.singleAnswerThreshold?(s=this.template_single_many,o=this.answerDisplayTypes.LIST_SELECT):(s=this.template_single_few,o=this.answerDisplayTypes.EL_CLICK);break;case"multi-select":s=this.template_multi,o=this.answerDisplayTypes.CHECK_BUTTON_CLICK;break;case"single-date":s=this.template_single_date,o=this.answerDisplayTypes.SINGLE_DATE;break;default:r.error("Unknown answerType provided: "+this.model.get("answerType"));return}var u=this.template_base+s+this.template_end;this.$el.html(t.template(u,{question:this.model,answers:this.model.get("answers"),explanations:this.model.get("explanations")})),this.$el.find("div.question-explanation-header").click(t.bind(this.onQuestionExplanationHeaderClick,this));switch(o){case this.answerDisplayTypes.EL_CLICK:this.$el.find("#answers_"+this.model.get("id")+" .answer").click(t.bind(function(n){var r=e(n.target);r.hasClass("answer")||(r=r.parents("div.answer")),this.$el.find("div.selected-answer-pad").removeClass("selected-answer-pad"),r.addClass("selected-answer-pad"),this.onAnswersSelected([r.find("div.answer-content").html()]),window.setTimeout(t.bind(this.onQuestionAnswered,this),300)},this));break;case this.answerDisplayTypes.LIST_SELECT:this.$el.find("#answers_"+this.model.get("id")+" .multi_answer_select").change(t.bind(function(e){this.onAnswersSelected(e.target.value?[e.target.value]:[]),window.setTimeout(t.bind(this.onQuestionAnswered,this),300)},this));break;case this.answerDisplayTypes.CHECK_BUTTON_CLICK:this.$el.find("span.answer-checkbox-text").click(function(t){e(this).parent().find("input[type=checkbox]").click()}),this.$el.find("div.answers").find("input[type=checkbox]").change(t.bind(function(n){var r=[],i=e(n.target).parents("div.answers").find("input:checked");t.each(i,function(e){var t=e.id.replace(/q(\d+)_a_/,"");r.push(this.model.get("answers")[t])},this),this.onAnswersSelected(r)},this)),this.$el.find("#answers_"+this.model.get("id")+" button.continue").click(t.bind(function(e){this.onQuestionAnswered()},this));break;case this.answerDisplayTypes.SINGLE_DATE:this.$el.find("#answers_"+this.model.get("id")+" input.date-selector").on("change",t.bind(function(e){e.target.value!==""?this.onAnswersSelected([e.target.value]):this.onAnswersSelected([]),window.setTimeout(t.bind(this.onQuestionAnswered,this),300)},this)).on("focus",function(){e(this).hasClass("hint-text")&&e(this).val("").removeClass("hint-text")});break;default:r.error("Unknown answerStyle provided: "+o);return}},onAnswersSelected:function(e){r.debug("QuestionView.onAnswerSelected("+e.join(", ")+")"),this.model.set("selectedAnswers",e)},onQuestionAnswered:function(){r.debug("Question answered: "+this.model.get("id")),this.model.set("questionAnswered",(new Date).getTime())},onQuestionExplanationHeaderClick:function(){this.$el.find("div.question-explanation-content").slideToggle(100,t.bind(function(){this.container&&typeof this.container.onChildContentResize=="function"&&this.container.onChildContentResize.apply(this.container,[])},this))},onBeforeShow:function(){r.debug("QuestionView.onBeforeShow: "+this.model.get("id"));if(!this.hadFirstShow){var e=this.$el.find("select.multi_answer_select");e.length&&!e.hasClass("form-control")&&e.addClass("form-control");var t=this.$el.find("input.date-selector");t.length&&t.datepicker({showOn:"both",dateFormat:"yy/mm/dd",changeMonth:!0,changeYear:!0,yearRange:"1950:"+(new Date).getFullYear()}),this.hadFirstShow=!0}}})}),define("theme/OutcomePreviewView",["jquery","underscore","backbone"],function(e,t,n){return n.View.extend({template:['<div title="<%= title %>" class="clickable clickable-colour">','	<img src="images/0.png" class="<%= imageClasses %>" height="75px" width="75px" alt="<%= title %>" />',"	<br />",'	<div class="outcome-preview-abbreviation"><%= abbreviation %></div>',"</div>"].join(""),render:function(){var e=this.model.get("title"),n=this.model.get("imageClasses");this.$el.html(t.template(this.template,{title:e,imageClasses:n,abbreviation:this.model.get("abbreviation")}))}})}),define("theme/OutcomePreviewsView",["jquery","underscore","backbone","flow/Log","theme/OutcomePreviewView"],function(e,t,n,r,i){return n.View.extend({el:"#flow_outcome_previews",template:['<div class="row">','	<div class="col-24 col-sm-24 col-md-24 col-lg-24">',"		<hr />",'		<h4 id="flow_options_preview_title" class="clickable clickable-colour">Your Options</h4>',"	</div>","</div>",'<div class="row">','	<div class="col-24 col-xs-24 col-sm-24 col-md-24 col-lg-24">','		<table cellpadding="0">',"			<tr>","				<td>",'					<div id="flow_available_count_main_container" class="clickable">','						<span id="flow_available_count_main"><%= availableCount %></span>',"					</div>","				</td>",'				<td style="overflow: hidden;">','					<div id="flow_available_outcome_previews" class="available-outcome-preview-container"><%= previewHtml %></div>','					<div class="clearer"></div>',"				</td>","			</tr>","		</table>","	</div>","</div>",'<div class="spacer-10"></div>','<div class="row">','	<div class="col-24 col-xs-24 col-sm-24 col-md-24 col-lg-24">','		<div id="flow_outcome_recent_changes" class="alert alert-info">','			<span id="flow_outcome_history_back" class="clickable outcome-history-nav"><span class="glyphicon glyphicon-chevron-left"></span></span>','			<span id="flow_outcome_history_fwd" class="clickable outcome-history-nav"><span class="glyphicon glyphicon-chevron-right"></span></span>','			<div id="flow_outcome_recent_changes_content"></div>','			<div class="clearer">',"		</div>","	</div>","</div>"].join(""),outcome_preview_template:['<div id="<%= outcomeElId %>"<%= displayStyle %> class="available-outcome-preview-container available-outcome-preview"></div>'].join(""),changeHistory:[],changeHistoryPosition:-1,render:function(e){this.onPreviewClicked=e;var n=0;t.each(this.model.models,function(e){e.get("available")&&n++}),this.$el.html(t.template(this.template,{availableCount:n,previewHtml:this.getAvailablePreviewsHtml()})),this.$el.find("#flow_available_count_main_container,#flow_options_preview_title").click(t.bind(this.onAvailableCountClicked,this)),this.handlePreviewClicks()},getAvailablePreviewsHtml:function(){var n=e("#flow_scratch"),r,s;t.each(this.model.models,function(e){s=this.getPreviewContainerIdFromOutcome(e),n.append(t.template(this.outcome_preview_template,{outcomeElId:s,displayStyle:e.get("available")?"":' style="display: none;"'})),r=new i({el:"#"+s,model:e}),r.render()},this);var o=n.html();return n.html(""),o},getPreviewContainerIdFromOutcome:function(e){return"op_"+e.get("id")},getOutcomeIdFromPreviewContainerId:function(e){return e.replace(/op_/,"")},getTextLinkIdFromOutcome:function(e){return"optl_"+(new Date).getTime()+"_"+e.get("id")},getOutcomeIdFromTextLinkId:function(e){return e.replace(/optl_\d+_/,"")},handlePreviewClicks:function(){this.$el.find("#flow_available_outcome_previews .available-outcome-preview").click(t.bind(function(t){var n=e(t.target),r=n.hasClass("available-outcome-preview")?n:n.parents(".available-outcome-preview"),i=r.attr("id"),s=this.model.findWhere({id:this.getOutcomeIdFromPreviewContainerId(i)});this.onPreviewClicked(s)},this))},onAvailableCountClicked:function(){this.onPreviewClicked()},onPreviewClicked:function(e){r.error("OutcomePreviewView.onPreviewClicked has not been overridden. Nothing is going to happen when a preview is clicked")},onQuestionAnswered:function(e){this.lastAnsweredQuestion=e},onOutcomesChanged:function(e){var n=0,r=300;t.each(this.model.models,function(e){e.get("available")&&n++});var i=this.$el.find("#flow_available_count_main");i.stop(),i.fadeOut(r,t.bind(function(){i.html(n),i.fadeIn(100)},this));var s=[],o=[];t.each(e.added,function(e){var t=this.$el.find("#"+this.getPreviewContainerIdFromOutcome(e));t.stop(),t.fadeIn(r),s.push('<li class="clickable clickable-colour outcome-text-link" id="'+this.getTextLinkIdFromOutcome(e)+'">'+e.get("title")+"</li>")},this),t.each(e.removed,function(e){var t=this.$el.find("#"+this.getPreviewContainerIdFromOutcome(e));t.stop(),t.fadeOut(r),o.push('<li class="clickable clickable-colour outcome-text-link" id="'+this.getTextLinkIdFromOutcome(e)+'">'+e.get("title")+"</li>")},this);var u=this.$el.find("#flow_outcome_recent_changes"),a=u.find("#flow_outcome_recent_changes_content"),f=!!s.length,l=!!o.length,c=f&&l?" and":"";u.is(":visible")||(u.stop(),u.slideDown(r)),this.changeHistory.push("Question "+this.lastAnsweredQuestion.get("id")+(f?" added <ul>"+s.join("")+"</ul>":"")+c+(l?" removed <ul>"+o.join("")+"</ul>":"")),this.changeHistoryPosition=this.changeHistory.length-1,a.html(this.changeHistory[this.changeHistoryPosition]),a.find(".outcome-text-link").click(t.bind(this.onOutcomeTextLinkClicked,this)),this.checkOutcomeHistoryNav()},onOutcomeTextLinkClicked:function(t){var n=e(t.target),r=this.model.findWhere({id:this.getOutcomeIdFromTextLinkId(n.attr("id"))});this.onPreviewClicked(r)},checkOutcomeHistoryNav:function(){var e=this.$el.find("#flow_outcome_history_back"),t=this.$el.find("#flow_outcome_history_fwd");this.changeHistoryPosition>0&&this.changeHistoryPosition<=this.changeHistory.length-1?e.css("visibility","visible"):e.css("visibility","hidden"),this.changeHistoryPosition>=0&&this.changeHistoryPosition<this.changeHistory.length-1?t.css("visibility","visible"):t.css("visibility","hidden"),this.changeHistory.length===1&&this.handleOutcomeHistoryNav(e,t)},handleOutcomeHistoryNav:function(e,n){var r=this.$el.find("#flow_outcome_recent_changes_content");e.click(t.bind(function(e){this.changeHistoryPosition--,r.html(this.changeHistory[this.changeHistoryPosition]).find(".outcome-text-link").click(t.bind(this.onOutcomeTextLinkClicked,this)),this.checkOutcomeHistoryNav()},this)),n.click(t.bind(function(e){this.changeHistoryPosition++,r.html(this.changeHistory[this.changeHistoryPosition]).find(".outcome-text-link").click(t.bind(this.onOutcomeTextLinkClicked,this)),this.checkOutcomeHistoryNav()},this))}})}),define("theme/OutcomeView",["jquery","underscore","backbone"],function(e,t,n){return n.View.extend({template:['<div title="<%= title %>" class="clickable outcome-view">','	<img src="images/0.png" class="<%= imageClasses %>" height="75px" width="75px" alt="<%= title %>" style="float: left;" />','	<h5 style="float: left; margin-left: 10px;"><%= title %></h5>','	<div style="clear: both;"></div>',"</div>"].join(""),render:function(){var e=this.model.get("title"),n=this.model.get("imageClasses");this.$el.html(t.template(this.template,{title:e,imageClasses:n}))}})}),define("theme/OutcomeManagerView",["jquery","underscore","backbone","theme/OutcomeView"],function(e,t,n,r){return n.View.extend({el:"#flow_outcomes",template:['<div class="modal" id="flow_outcome_modal" tabindex="-1" role="dialog" aria-labelledby="flow_outcome_modal_label" aria-hidden="true">','	<div class="modal-dialog">','		<div class="modal-content" style="-webkit-overflow-scrolling: touch;">','			<div class="modal-header">','				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>','				<h4 class="modal-title" id="flow_outcome_modal_label">Your Options</h4>',"			</div>",'			<div class="modal-body" id="flow_outcome_modal_body">','				<div id="flow_outcome_modal_unanswered_count" class="alert alert-warning"></div>','				<ul class="nav nav-tabs">','					<li id="flow_outcome_available_link"><a class="outcome-tab-link" href="#flow_outcome_available" data-toggle="tab">Available</a></li>','					<li><a class="outcome-tab-link" href="#flow_outcome_unavailable" data-toggle="tab">Unavailable</a></li>','					<li style="display: none;" id="flow_outcome_detail_link"><a class="outcome-tab-link" href="#flow_outcome_detail" data-toggle="tab">Detail</a></li>',"				</ul>",'				<div class="tab-content">','					<div class="tab-pane active" id="flow_outcome_available">','						<div class="spacer-10"></div>','						<p id="flow_some_options_note">Based on the questions you have answered the following options may be available to you.</p>','						<div id="flow_no_options_note_container">',"							<h4>No Available Options</h4>","							<p>Based on the questions you have answered we have not been able to find any suitable options.</p>","							<p>Please note that an automated tool cannot provide perfect results and therefore we recommend that you discuss your case with a CCIJ lawyer.</p>","						</div>",'						<div id="flow_outcome_available_outcomes"></div>',"					</div>",'					<div class="tab-pane" id="flow_outcome_unavailable">','						<div class="spacer-10"></div>',"						<p>Based on the questions you have answered the following options may not be available to you.</p>",'						<div id="flow_outcome_unavailable_outcomes"></div>',"					</div>",'					<div class="tab-pane" id="flow_outcome_detail"></div>',"				</div>","			</div>",'			<div class="modal-footer">','				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>',"			</div>","		</div>","	</div>","</div>"].join(""),outcome_template:['<div class="row">','	<div id="<%= outcomeElId %>" class="outcome-manager-outcome-container col-24 col-xs-24 col-sm-24 col-md-24 col-lg-24">',"	</div>","</div>"].join(""),render:function(){this.$el.html(t.template(this.template)),this.modal=this.$el.find("#flow_outcome_modal"),this.modalContent=this.modal.find(".modal-content"),this.$el.find("#flow_outcome_modal_body a.outcome-tab-link").click(function(t){t.preventDefault(),e(this).tab("show")}),this.availableOutcomesContainer=this.$el.find("#flow_outcome_available_outcomes"),this.unavailableOutcomesContainer=this.$el.find("#flow_outcome_unavailable_outcomes"),this.someOptionsNote=this.$el.find("#flow_some_options_note"),this.noOptionsNote=this.$el.find("#flow_no_options_note_container")},showOutcomesInModal:function(){this.renderOutcomesInModal(),this.$el.find("#flow_outcome_available_link a").tab("show"),this.modal.modal()},showOutcomeInModal:function(e,t){t=typeof t=="undefined"?!1:!!t,t||(this.renderOutcomesInModal(),this.modal.modal()),this.$el.find("#flow_outcome_detail_link").show().find(">a").html(e.get("abbreviation")).tab("show"),this.$el.find("#flow_outcome_detail").html(e.get("selector").html())},renderOutcomesInModal:function(){this.availableOutcomesContainer.html(""),this.unavailableOutcomesContainer.html("");var n,i,s=0;t.each(this.model.models,function(o,u){n=this.getContainerIdFromOutcome(o),i=e(t.template(this.outcome_template,{outcomeElId:n})),o.get("available")?(s++,this.availableOutcomesContainer.append(i)):this.unavailableOutcomesContainer.append(i),(new r({model:o,el:"#"+n})).render()},this),s===0?(this.someOptionsNote.hide(),this.noOptionsNote.show()):(this.someOptionsNote.show(),this.noOptionsNote.hide()),this.modal.find(".outcome-manager-outcome-container").click(t.bind(function(t){var n=e(t.target),r=n.hasClass("outcome-manager-outcome-container")?n:n.parents(".outcome-manager-outcome-container"),i=r.attr("id"),s=this.model.findWhere({id:this.getOutcomeIdFromContainerId(i)});this.showOutcomeInModal(s,!0)},this));if(this.unansweredQuestions>0){var o=this.unansweredQuestions>1?"s are":" is";this.$el.find("#flow_outcome_modal_unanswered_count").show().html(this.unansweredQuestions+" question"+o+" unanswered.")}else this.$el.find("#flow_outcome_modal_unanswered_count").hide()},getContainerIdFromOutcome:function(e){return"o_"+e.get("id")},getOutcomeIdFromContainerId:function(e){return e.replace(/o_/,"")}})}),define("theme/FeedbackView",["jquery","underscore","backbone"],function(e,t,n){return n.View.extend({template:['<div class="modal" id="flow_feedback_modal" tabindex="-1" role="dialog" aria-labelledby="flow_feedback_modal_label" aria-hidden="true">','	<div class="modal-dialog">','		<div class="modal-content">','			<div class="modal-header">','				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>','				<h4 class="modal-title" id="flow_feedback_modal_label">Send Feedback</h4>',"			</div>",'			<div class="modal-body" id="flow_feedback_modal_body">',"				<h4>Your Email Address</h4>",'				<div class="input-group">','					<span class="input-group-addon">@</span>','					<input id="flow_feedback_from" type="text" class="form-control" placeholder="Your Email Address">',"				</div>","				<br />","				<h4>Your Comment</h4>",'				<textarea id="flow_feedback_message" class="form-control" rows="5"></textarea>',"				<br />",'				<button type="button" id="flow_feedback_send" disabled="disabled" class="btn btn-primary">Send</button> ','				<img id="flow_feedback_load" src="images/small-load.gif" width="24px" height="24px" style="display: none;" />','				<span class="glyphicon glyphicon-ok" id="flow_feedback_success" style="display: none;" title="Feedback sent"></span>','				<span class="glyphicon glyphicon-remove" id="flow_feedback_fail" style="display: none;" title="Send failed"></span>',"			</div>",'			<div class="modal-footer">','				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>',"			</div>","		</div>","	</div>","</div>"].join(""),render:function(){if(!this.content){var n=e("#flow_scratch");n.html(t.template(this.template)),this.content=n.find("#flow_feedback_modal"),n.html(""),this.sendButton=this.content.find("#flow_feedback_send").click(t.bind(this.onSendClicked,this)),this.from=this.content.find("#flow_feedback_from").addClass("input-attention").on("keyup",t.bind(this.onFromChanged,this)),this.message=this.content.find("#flow_feedback_message").addClass("input-attention").on("keyup",t.bind(this.onMessageChanged,this)),this.loadImg=this.content.find("#flow_feedback_load"),this.successImg=this.content.find("#flow_feedback_success"),this.failImg=this.content.find("#flow_feedback_fail")}this.content.modal()},onFromChanged:function(){this.fromValid()?(this.from.removeClass("input-attention"),this.messageValid()&&this.sendButton.removeAttr("disabled")):this.sendButton.attr("disabled","disabled")},onMessageChanged:function(){this.messageValid()?(this.message.removeClass("input-attention"),this.fromValid()&&this.sendButton.removeAttr("disabled")):this.sendButton.attr("disabled","disabled")},fromValid:function(){return!!this.from.val().match(/[a-z0-9!#$%&'*+\/=?^_{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i)},messageValid:function(){return!!this.message.val().match(/.{10}/i)},onSendClicked:function(){this.loadImg.show(),this.successImg.hide(),this.failImg.hide(),this.sendButton.attr("disabled","disabled"),e.ajax("feedback/",{type:"POST",data:{from:this.from.val(),message:this.message.val()},success:t.bind(this.onSendSuccess,this),error:t.bind(this.onSendError,this)})},onSendSuccess:function(){this.loadImg.hide(),this.successImg.show(),this.sendButton.removeAttr("disabled")},onSendError:function(){this.loadImg.hide(),this.failImg.show(),this.sendButton.removeAttr("disabled")}})}),define("theme/ResultsSenderView",["jquery","underscore","backbone"],function(e,t,n){return n.View.extend({template:['<div class="modal" id="flow_results_sender_modal" tabindex="-1" role="dialog" aria-labelledby="flow_feedback_results_sender_label" aria-hidden="true">','	<div class="modal-dialog">','		<div class="modal-content">','			<div class="modal-header">','				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>','				<h4 class="modal-title" id="flow_feedback_modal_label">Email Results</h4>',"			</div>",'			<div class="modal-body" id="flow_results_sender_modal_body">',"				<h4>Your Email Address</h4>",'				<div class="input-group">','					<span class="input-group-addon">@</span>','					<input id="flow_results_sender_to" type="text" class="form-control" placeholder="Your Email Address">',"				</div>","				<br />",'				<button type="button" id="flow_results_sender_send" disabled="disabled" class="btn btn-primary">Send</button> ','				<img id="flow_results_sender_load" src="images/small-load.gif" width="24px" height="24px" style="display: none;" />','				<span class="glyphicon glyphicon-ok" id="flow_results_sender_success" style="display: none;" title="Feedback sent"></span>','				<span class="glyphicon glyphicon-remove" id="flow_results_sender_fail" style="display: none;" title="Send failed"></span>',"			</div>",'			<div class="modal-footer">','				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>',"			</div>","		</div>","	</div>","</div>"].join(""),render:function(n){if(!this.content){var r=e("#flow_scratch");r.html(t.template(this.template)),this.content=r.find("#flow_results_sender_modal"),r.html(""),this.sendButton=this.content.find("#flow_results_sender_send").click(t.bind(this.onSendClicked,this)),this.to=this.content.find("#flow_results_sender_to").addClass("input-attention").on("keyup",t.bind(this.onToChanged,this)),this.loadImg=this.content.find("#flow_results_sender_load"),this.successImg=this.content.find("#flow_results_sender_success"),this.failImg=this.content.find("#flow_results_sender_fail")}this.content.modal()},onToChanged:function(){this.toValid()?(this.to.removeClass("input-attention"),this.sendButton.removeAttr("disabled")):this.sendButton.attr("disabled","disabled")},toValid:function(){return!!this.to.val().match(/[a-z0-9!#$%&'*+\/=?^_{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i)},onSendClicked:function(){this.loadImg.show(),this.successImg.hide(),this.failImg.hide(),this.sendButton.attr("disabled","disabled"),e.ajax("results/",{type:"POST",data:{to:this.to.val(),message:e("#flow_print").html()},success:t.bind(this.onSendSuccess,this),error:t.bind(this.onSendError,this)})},onSendSuccess:function(){this.loadImg.hide(),this.successImg.show(),this.sendButton.removeAttr("disabled")},onSendError:function(){this.loadImg.hide(),this.failImg.show(),this.sendButton.removeAttr("disabled")}})}),define("theme/ContentView",["jquery","underscore","backbone","theme/QuestionView","theme/OutcomePreviewsView","theme/OutcomePreviewView","theme/OutcomeManagerView","theme/OutcomeView","theme/FeedbackView","theme/ResultsSenderView","flow/Log","bootstrap"],function(e,t,n,r,i,s,o,u,a,f,l){return n.View.extend({el:"#flow_content",template:['<div class="container">','	<div class="row">','		<div class="col-24 col-sm-24 col-md-24 col-lg-24">',"			<h4>Questions</h4>",'			<span id="flow_feedback_icon" class="glyphicon glyphicon-send clickable"></span>','			<span id="flow_send_results_icon" class="glyphicon glyphicon-envelope clickable"></span>',"		</div>","	</div>",'	<div id="flow_question_summary"></div>',"</div>",'<div class="spacer-5"></div>','<div class="container">','	<div class="row">','		<div id="flow_carousel" class="carousel slide col-xs-24 col-sm-24 col-md-24 col-lg-24 col-24" data-ride="carousel">','			<div id="flow_carousel_navigation">','				<div id="flow_carousel_navigation_back" class="flow-carousel-navigation clickable"><span class="glyphicon glyphicon-chevron-left"></span></div>','				<div id="flow_carousel_navigation_forward" class="flow-carousel-navigation clickable"><span class="glyphicon glyphicon-chevron-right"></span></div>',"			</div>",'			<div id="flow_content_items" class="carousel-inner"></div>',"		</div>","	</div>","</div>",'<div id="flow_outcome_previews" class="container"></div>','<div id="flow_outcomes" class="container"></div>'].join(""),summary_template:['<button type="button" id="<%= summaryQuestionElId %>" class="btn <%= summaryClass %>"><%= questionId %></button>'].join(""),questions:[],backPermitted:!1,fwdPermitted:!1,render:function(){l.debug("ContentView.render"),this.$el.append(this.template),this.$el.find("#flow_carousel_navigation_back").click(t.bind(this.onBackSelected,this)),this.$el.find("#flow_carousel_navigation_forward").click(t.bind(this.onForwardSelected,this)),this.$el.find("#flow_feedback_icon").click(t.bind(this.onFeedbackIconClicked,this)),this.$el.find("#flow_send_results_icon").click(t.bind(this.onSendResultsIconClicked,this)),e(window).resize(t.bind(this.onWindowResize,this))},addQuestions:function(n){if(this.addQuestionsCalled){l.error("ContentView.addQuestions called twice");return}this.addQuestionsCalled=!0,l.debug("ContentView.addQuestions");var i=e("#flow_scratch"),s=this.$el.find("#flow_question_summary"),o=0;t.each(n,function(n){var u=n.get("id");l.debug("ContentView.addQuestion ("+u+"), first: "+(this.hadFirst?"false":"true"));var a=this.getQuestionContainerId(u),f=e('<div id="'+a+'" class="question-container"></div>');i.append(f);var c;n.get("available")?this.hadFirst?c="btn-default":c="btn-primary":c="btn-unavailable";var h=this.getSummaryQuestionId(u),p=e(t.template(this.summary_template,{summaryQuestionElId:h,summaryClass:c,questionId:u}));s.append(p),p.click(t.bind(this.onSummaryQuestionClicked,this)),n.on("change:selectedAnswers",t.bind(this.onAnswersSelected,this)),n.on("change:available",t.bind(this.onQuestionAvailabilityChanged,this));var d=new r({el:"#"+a,model:n});d.render(!this.hadFirst,this),this.questions.push({id:u,view:d,active:!this.hadFirst}),n.get("available")&&o++,this.hadFirst||(this.hadFirst=!0)},this),this.$el.find("#flow_content_items").append(i.find("div.question-container")),this.$el.find("#flow_carousel").on("swipeleft",t.bind(this.onSwipeLeft,this)).on("swiperight",t.bind(this.onSwipeRight,this)),this.outcomeManager.unansweredQuestions=o},showFirstQuestion:function(){l.debug("ContentView.showFirstQuestion"),this.$carouselEl=this.$el.find("#flow_carousel").carousel({pause:!0,interval:!1}),this.resizeQuestionContainers(!1),this.$carouselEl.on("slide.bs.carousel",t.bind(this.onSlideStart,this)),this.$carouselEl.on("slid.bs.carousel",t.bind(this.onSlideStop,this)),this.checkNavigationOptions(),this.questions[0].view.onBeforeShow()},showNextQuestion:function(){l.debug("ContentView.showNextQuestion");var e=this.getIndexOfNextAvailableQuestion();e>-1?(l.debug("Advancing to "+e),t.each(this.questions,function(t,n){n===e?(t.active=!0,t.view.onBeforeShow()):t.active=!1},this),this.$carouselEl.carousel(e),this.checkNavigationOptions()):(l.debug("No more questions available"),this.outcomeManager&&this.outcomeManager.showOutcomesInModal())},showPreviousQuestion:function(){l.debug("ContentView.showPreviousQuestion");var e=this.getIndexOfPreviousAvailableQuestion();e>-1?(l.debug("Reverting to "+e),t.each(this.questions,function(t,n){n===e?(t.active=!0,t.view.onBeforeShow()):t.active=!1},this),this.$carouselEl.carousel(e),this.checkNavigationOptions()):l.debug("No previous questions available")},checkNavigationOptions:function(){this.getIndexOfPreviousAvailableQuestion()===-1?(this.backPermitted=!1,this.$el.find("#flow_carousel_navigation_back").css("visibility","hidden")):(this.backPermitted=!0,this.$el.find("#flow_carousel_navigation_back").css("visibility","visible")),this.getIndexOfNextAvailableQuestion()===-1?(this.fwdPermitted=!1,this.$el.find("#flow_carousel_navigation_forward").css("visibility","hidden")):(this.fwdPermitted=!0,this.$el.find("#flow_carousel_navigation_forward").css("visibility","visible"))},getIndexOfNextAvailableQuestion:function(){l.debug("ContentView.getIndexOfNextAvailableQuestion");var e=-1,n=-1;return t.each(this.questions,function(e,t){e.active&&(n=t)},this),n<0?(l.error("Unable to find currently active view index"),e):(l.debug("ActiveIndex: "+n),n===this.questions.length-1?(l.info("Reached end of available questions (index: "+n+")"),e):(t.each(this.questions,function(t,r){if(r>n&&e===-1){var i=t.view.model,s;s=i.get("id"),i.get("available")?(l.debug("Next available question: "+s),e=r):l.debug("Next question not available ("+s+")")}},this),e))},getIndexOfPreviousAvailableQuestion:function(){l.debug("ContentView.getIndexOfPreviousAvailableQuestion");var e=-1,n=-1;t.each(this.questions,function(e,t){e.active&&(n=t)},this);if(n<0)return l.error("Unable to find currently active view index"),e;l.debug("ActiveIndex: "+n);if(n===0)return l.info("Reached beginning of available questions (index: "+n+")"),e;var r;for(r=this.questions.length-1;r>=0;r--)if(r<n&&e===-1){var i=this.questions[r].view.model,s=i.get("id");i.get("available")?(l.debug("Previous available question: "+s),e=r):l.debug("Previous question not available ("+s+")")}return e},onSlideStart:function(){this.$el.find("div.flow-carousel-navigation").prop("disabled",!0)},onSlideStop:function(t){var n=e(t.target).find(".active").attr("id"),r=this.getQuestionIdFromContainerId(n),i=this.$el.find("#"+this.getSummaryQuestionId(r)),s=this.$el.find("button.btn-primary");s&&(s.removeClass("btn-primary"),s.data("answered")?s.addClass("btn-success"):s.addClass("btn-default")),i.removeClass("btn-default btn-success").addClass("btn-primary"),this.$el.find("div.flow-carousel-navigation").prop("disabled",!1),this.resizeQuestionContainers(!0)},onQuestionAvailabilityChanged:function(e){var t=e.get("id");l.debug("question availability changed: "+t);var n=this.$el.find("#"+this.getSummaryQuestionId(t)),r=e.get("available");r?(n.removeClass("btn-unavailable"),n.data("answered")?n.addClass("btn-success"):n.addClass("btn-default")):n.removeClass("btn-default btn-success").addClass("btn-unavailable"),this.outcomeManager.unansweredQuestions=this.countUnansweredQuestions(e.collection.models)},onSummaryQuestionClicked:function(n){var r=e(n.target);if(!r.hasClass("btn-unavailable")){var i=this.getQuestionIdFromSummaryElementId(r.attr("id")),s=-1,o;t.each(this.questions,function(e,t){e.id==i?(s=t,e.active=!0,o=e.view):e.active=!1}),s>-1&&(o.onBeforeShow(),this.$carouselEl.carousel(s),this.checkNavigationOptions())}},onAnswersSelected:function(e,t){l.debug("ContentView.onAnswersSelected");var n=this.$el.find("#"+this.getSummaryQuestionId(e.get("id"))),r=e.get("selectedAnswers").length>0;r?n.data("answered",!0):n.data("answered",!1),this.outcomeManager.unansweredQuestions=this.countUnansweredQuestions(e.collection.models),this.outcomePreviews.onQuestionAnswered(e)},countUnansweredQuestions:function(e){var n=0;return t.each(e,function(e){if(e.get("available")){var t=e.get("selectedAnswers");(!t||!t.length)&&n++}}),n},addOutcomes:function(e){l.debug("ContentView.addOutcomes"),this.outcomePreviews=new i({model:e}),this.outcomeManager=new o({model:e}),this.outcomeManager.render(),this.outcomePreviews.render(t.bind(this.outcomeShowRequested,this))},outcomeShowRequested:function(e){e?this.outcomeManager.showOutcomeInModal(e):this.outcomeManager.showOutcomesInModal()},getQuestionContainerId:function(e){return"question_container_"+e},getQuestionIdFromContainerId:function(e){return e.replace(/question_container_/,"")},getSummaryQuestionId:function(e){return"summary_question_"+e},getQuestionIdFromSummaryElementId:function(e){return e.replace(/summary_question_/,"")},onBackSelected:function(e){this.showPreviousQuestion()},onForwardSelected:function(e){this.showNextQuestion()},onSwipeLeft:function(){this.fwdPermitted&&this.showNextQuestion()},onSwipeRight:function(){this.backPermitted&&this.showPreviousQuestion()},resizeQuestionContainers:function(e,n){var r,i=[];t.each(this.questions,function(e){e.active?r=e.view.$el:i.push(e.view.$el)});var s=this.$el.find(".flow-carousel-navigation");r.stop(!0),s.stop(!0);var o=r.find(".carousel-caption").height();if(o===0)return;o%2!==0&&(o+=1);var u=o+20+"px",a=(o>0?Math.round(o/2):0)+"px";e?(n=isNaN(n)?180:n,r.animate({height:u},n),s.animate({"padding-top":a,"padding-bottom":a},n)):(r.height(u),s.css("padding-top",a).css("padding-bottom",a)),t.each(i,function(e){e.height(u)})},onWindowResize:function(e){this.resizeQuestionContainers(!1)},onChildContentResize:function(){this.resizeQuestionContainers(!0,100)},onOutcomesChanged:function(e){this.outcomePreviews.onOutcomesChanged(e)},onFeedbackIconClicked:function(){this.feedbackView||(this.feedbackView=new a),this.feedbackView.render()},onSendResultsIconClicked:function(){this.resultsSenderView||(this.resultsSenderView=new f),this.resultsSenderView.render()}})}),define("flow/MainView",["jquery","underscore","backbone","flow/Log","theme/ContentView"],function(e,t,n,r,i){return n.View.extend({initialize:function(){r.debug("Initialising MainView"),this.questions=this.model.get("Questions"),this.outcomes=this.model.get("Outcomes"),this.questions.listenToOnce(this.questions,"start",t.bind(this.onStart,this)),this.questions.on("change:selectedAnswers",t.bind(this.onAnswersSelected,this)),this.questions.on("change:questionAnswered",t.bind(this.onQuestionAnswered,this))},render:function(){r.debug("MainView.render"),this.$el.show(),this.content=new i,this.content.render(),this.content.addOutcomes(this.outcomes)},onStart:function(){r.debug("MainView.onStart"),this.render(),this.content.addQuestions(this.questions.models),this.content.showFirstQuestion()},onAnswersSelected:function(e,t){var n=this.questions.checkAvailableQuestions();n.push(e);var r=this.outcomes.checkAvailableOutcomes(this.questions,n);r.added.concat(r.removed).length&&this.content.onOutcomesChanged(r)},onQuestionAnswered:function(e){this.content.showNextQuestion()}})}),define("flow/PrintView",["jquery","underscore","backbone","flow/Log"],function(e,t,n,r){return n.View.extend({question_template:['<div id="<%= questionElementId %>" class="print-question">','	<p>Question <%= questionId %> (<span class="question-availability-flag"><%= questionAvailability %></span>): <%= questionText %></p>','	<p>Answer(s): <span class="question-answers">(none)</span>',"</div>"].join(""),outcomes_template:["<h5>The following mechanisms may be available, based on the answers you have provided.</h5>","<ul>","	<% _.each(outcomes, function(outcome) { %>","		<li><%= outcome %></li>","	<% }); %>","</ul>"].join(""),availableOutcomes:[],initialize:function(){r.debug("Initialising PrintView"),this.questions=this.model.get("Questions"),this.outcomes=this.model.get("Outcomes"),this.questions.on("change:selectedAnswers",t.bind(this.onAnswersSelected,this)),this.questions.on("change:available",t.bind(this.onQuestionAvailabilityChanged,this)),this.outcomes.on("change:available",t.bind(this.onOutcomeAvailabilityChanged,this))},render:function(){var n=e("#flow_scratch"),r;t.each(this.questions.models,function(e){r=t.template(this.question_template,{questionId:e.get("id"),questionAvailability:e.get("available")?"available":"unavailable",questionElementId:this.getElementIdFromQuestion(e),questionText:e.get("content")}),n.append(r)},this),this.$el.find("#flow_questions_print").html(n.html()),n.html(""),t.each(this.outcomes.models,function(e){e.get("available")&&this.availableOutcomes.push(e.get("title"))},this),this.$el.find("#flow_outcomes_print").html(t.template(this.outcomes_template,{outcomes:this.availableOutcomes}))},onAnswersSelected:function(e,t){this.$el.find("#"+this.getElementIdFromQuestion(e)+" .question-answers").html(t.length?t.join(", "):"(none)")},onQuestionAvailabilityChanged:function(e){this.$el.find("#"+this.getElementIdFromQuestion(e)+" .question-availability-flag").html(e.get("available")?"available":"unavailable")},onOutcomeAvailabilityChanged:function(e){this.availableOutcomes=[],t.each(this.outcomes.models,function(e){e.get("available")&&this.availableOutcomes.push(e.get("title"))},this),this.$el.find("#flow_outcomes_print").html(t.template(this.outcomes_template,{outcomes:this.availableOutcomes}))},getElementIdFromQuestion:function(e){return"flow_question_print_"+e.get("id")}})}),define("flow/Question",["jquery","underscore","backbone","flow/Log"],function(e,t,n,r){return n.Model.extend({dateWhens:{BOO:"before or on",AOO:"after or on"},isAnswered:function(){if(!this.get("available"))return!1;var e=this.get("selectedAnswers");return typeof e!="undefined"&&e.length?!0:!1},isNotAnswered:function(){return!this.isAnswered()},isUnknownOrNotAnswered:function(){return!this.isAnswered()||this.hasAnswer("Unknown")},hasAnswer:function(e){var n=t.find(this.get("answers"),function(t){return e==t});if(!n)return r.error('Question "'+this.get("id")+'" checked for answer but answer "'+e+'" not available'),!1;if(!this.get("available")||typeof this.get("selectedAnswers")=="undefined")return!1;var i=!!t.find(this.get("selectedAnswers"),function(t){return e==t});return i},doesNotHaveAnswer:function(e){return!this.hasAnswer(e)},hasOneOfAnswers:function(e){return!!t.find(e,function(e){return this.hasAnswer(e)},this)},checkDate:function(e,t){var n=/\d{4}\/\d{2}\/\d{2}/;if(typeof e!="string"||!e.match(n)){r.error("checkDate supplied with bad checkDateStr format. Must be YYYY/MM/DD");return}var i=this.get("selectedAnswers");if(!i||!i.length)return!1;if(i.length>1)return r.error("checkDate attempting to check date on answers array with > 1 entry"),!1;selectedDateStr=i[0];if(typeof selectedDateStr!="string"||!selectedDateStr.match(n)){r.error("checkDate supplied with bad selectedDateStr format. Must be YYYY/MM/DD");return}var s=new Date(e),o=new Date(selectedDateStr);switch(t){case this.dateWhens.AOO:return o>=s;case this.dateWhens.BOO:return o<=s;default:return!1}},isAfterOrOnDate:function(e){return this.checkDate(e,this.dateWhens.AOO)},isBeforeOrOnDate:function(e){return this.checkDate(e,this.dateWhens.BOO)},isBetweenDates:function(e,t){return this.isAfterOrOnDate(e)&&this.isBeforeOrOnDate(t)}})}),define("flow/QuestionManager",["jquery","underscore","backbone","flow/Log","flow/Question"],function(e,t,n,r,i){return new(n.Collection.extend({model:i,initialize:function(){t.each(this.models,function(t){var n=t.get("content");n||(n=e("#q"+t.get("id")).html(),t.set("content",n),n||r.warn("No content available for question "+t.get("id")))},this),this.on("reset",t.bind(this.onReset,this))},onReset:function(){this.indexedQuestions=t.indexBy(this.models,function(e){return e.get("id")}),t.each(this.models,function(e){var t=e.get("condition");typeof t=="function"?e.set("available",t.apply(this,[this.indexedQuestions])):e.set("available",!0)},this)},readyForFirstQuestion:function(){r.debug("QuestionManager triggering start"),this.trigger("start")},checkAvailableQuestions:function(){r.debug("QuestionManager.checkAvailableQuestions");var e=[];return t.each(this.models,function(t){var n=t.get("condition");if(typeof n=="function"){var r=n.apply(this,[this.indexedQuestions]);r!=t.get("available")&&e.push(t),t.set("available",r)}},this),e}}))}),define("flow/Util",[],function(){return{getIdFromText:function(e){var t="_";return e.match(/^\d/)&&(e=t+e),e.toLowerCase().replace(/[^a-z0-9]+/g,t)},generateId:function(){return"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})}}}),define("flow/Outcome",[],function(){return Backbone.Model.extend({})}),define("flow/OutcomeManager",["jquery","underscore","backbone","flow/Log","flow/Util","flow/Outcome"],function(e,t,n,r,i,s){return new(n.Collection.extend({model:s,initialize:function(){r.debug("Initialising OutcomeManager"),this.on("reset",t.bind(this.onReset,this))},onReset:function(){var e,n;t.each(this.models,function(r){r.set("id",i.generateId()),e=r.get("selector"),r.set("title",e.find(".outcome-title").html()),r.set("abbreviation",e.find(".outcome-abbreviation").html()||r.get("title").substring(0,10)+"..."),r.set("url",e.find(".outcome-url").html()),r.set("description",e.find(".outcome-description").html()),r.set("imageClasses",e.find("img").attr("class")),r.set("available",!0),n=r.get("condition");if(n){var s=n.toString(),o=s.indexOf("("),u=s.indexOf(")"),a=s.substring(o+1,u).match(/\bq\d+([a-z]+)?\b/ig);if(a){var f=[];t.each(a,function(e){f.push(e.replace(/^q/,""))}),r.set("depends",f)}}},this)},checkAvailableOutcomes:function(e,n){var r={added:[],removed:[]};return t.each(this.models,function(i){var s=i.get("condition"),o=i.get("depends"),u=[];if(s&&o){var a=!1;t.each(n,function(e){if(t.indexOf(o,e.get("id"))>-1)return a=!0,!1});if(a){t.each(o,function(t){u.push(e.get(t))});if(u.length){var f=s.apply(this,u);f&&!i.get("available")?r.added.push(i):!f&&i.get("available")&&r.removed.push(i),i.set("available",f)}}}},this),r}}))}),define("MainView",["jquery","underscore","backbone","data/en","flow/Log","flow/IntroView","flow/MainView","flow/PrintView","flow/QuestionManager","flow/OutcomeManager"],function(e,t,n,r,i,s,o,u,a,f){return n.View.extend({el:"#ccij_main",initialize:function(){this.intro=this.$el.find("#ccij_intro"),this.focuses=this.$el.find(".main-focus"),this.intro.find(".entry-point").addClass("clickable").on("click",t.bind(this.onEntryPointClicked,this)),e("#ccij_navbar .nav a").click(function(){e("#ccij_navbar .navbar-toggle").is(":visible")&&e("#ccij_navbar .navbar-collapse").is(":visible")&&e("#ccij_navbar .navbar-toggle").click()})},onEntryPointClicked:function(t){var n=e(t.target),r=n.hasClass("entry-point")?n:n.parents(".entry-point"),i=r.attr("id"),s=e("#"+i.replace(/entry$/,"nav")),o=s.attr("href");document.location.href=o},changeActiveNavTab:function(t){var n=e("#ccij_navbar");n.find("li.active").removeClass("active"),e("#"+t).parents("li").addClass("active")},onHomeSelected:function(){this.focuses.hide(),this.intro.show(),this.changeActiveNavTab("ccij_home_nav")},onRemediesSelected:function(){this.focuses.hide(),this.$el.find("#ccij_outcomes").show(),this.changeActiveNavTab("ccij_remedies_nav")},onAssessSelected:function(){this.focuses.hide(),this.flowShown||this.flowSelected(),this.$el.find("#flow").show(),this.flowShown=!0,this.changeActiveNavTab("ccij_assess_nav")},flowSelected:function(){if(!(r&&r.questions&&r.outcomes)){Log.error("Reached init script without adequate config");return}var e=new n.Model;e.set({Outcomes:f,Questions:a});var t=new s({model:a,el:"#flow_intro"});t.render(),new o({model:e,el:"#flow_body"}),f.reset(r.outcomes),a.reset(r.questions);var i=new u({model:e,el:"#flow_print"});i.render()}})}),define("Workspace",["jquery","underscore","backbone"],function(e,t,n){return n.Router.extend({initialize:function(e){this.mainView=e},routes:{"":"home",stories:"stories",remedies:"remedies",assess:"assess"},home:function(){this.mainView.onHomeSelected()},stories:function(){Log.warning("Stories not yet implemented")},remedies:function(){this.mainView.onRemediesSelected()},assess:function(){this.mainView.onAssessSelected()}})}),define("init",["jquery","underscore","backbone","MainView","Workspace"],function(e,t,n,r,i){e(function(){new i(new r),n.history.start()})});